import base64
exec(base64.b64decode('aW1wb3J0IGFzeW5jaW8KZnJvbSB0ZWxlZ3JhbSBpbXBvcnQgVXBkYXRlCmZyb20gdGVsZWdyYW0uZXh0IGltcG9ydCAoCiAgICBBcHBsaWNhdGlvbiwKICAgIE1lc3NhZ2VIYW5kbGVyLAogICAgTWVzc2FnZVJlYWN0aW9uSGFuZGxlciwKICAgIENvbW1hbmRIYW5kbGVyLAogICAgQ29udGV4dFR5cGVzLAogICAgZmlsdGVycwopCgppbXBvcnQgb3MKVE9LRU4gPSBvcy5nZXRlbnYoIkJPVF9UT0tFTiIpCkFETUlOX0lEID0gNTkyNTUyOTE2CgpsaW5rID0ge30KCnByaW50KCJCT1QgQ0FSR0FORE8uLi4iKQoKIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyAvc3RhcnQgLSBtZW5zYWplIGRlIGJpZW52ZW5pZGEKIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KYXN5bmMgZGVmIHN0YXJ0X2NtZCh1cGRhdGU6IFVwZGF0ZSwgY29udGV4dDogQ29udGV4dFR5cGVzLkRFRkFVTFRfVFlQRSk6CiAgICBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KAogICAgICAgICLwn5GL8J+PuyBIb2xhIEVzY3LDrWJlbWUgY3VhbHF1aWVyIGR1ZGEgYXF1w60gZW4gw6lzdGUgY2hhdCBwcm9ibGVtYXMgZXRjw6l0ZXJhIHNvYnLDqSBsb3MgTU9EUy5cblxuIgogICAgICAgICLwn5GL8J+PuyBIaSBXcml0ZSBtZSBhbnkgcXVlc3Rpb25zIGhlcmUgaW4gdGhpcyBjaGF0LCBwcm9ibGVtcywgZXRjLiBhYm91dCBNT0RTLiIKICAgICkKCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgTWVuc2FqZSBkZWwgdXN1YXJpbyDihpIgcmVlbnZpYXIgYWwgYWRtaW4gKyByZWFjY2nDs24gdGVtcG9yYWwKIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KYXN5bmMgZGVmIHJlY2liaXJfdXN1YXJpbyh1cGRhdGU6IFVwZGF0ZSwgY29udGV4dDogQ29udGV4dFR5cGVzLkRFRkFVTFRfVFlQRSk6CiAgICB1c2VyID0gdXBkYXRlLmVmZmVjdGl2ZV91c2VyCiAgICB1c2VyX2lkID0gdXNlci5pZAoKICAgICMgTm8gcmVlbnZpYXIgc2kgZXMgZWwgYWRtaW4KICAgIGlmIHVzZXJfaWQgPT0gQURNSU5fSUQ6CiAgICAgICAgcmV0dXJuCgogICAgIyBSZWVudmlhciBhbCBhZG1pbgogICAgcmVlbnZpYWRvID0gYXdhaXQgY29udGV4dC5ib3QuZm9yd2FyZF9tZXNzYWdlKAogICAgICAgIGNoYXRfaWQ9QURNSU5fSUQsCiAgICAgICAgZnJvbV9jaGF0X2lkPXVzZXJfaWQsCiAgICAgICAgbWVzc2FnZV9pZD11cGRhdGUubWVzc2FnZS5tZXNzYWdlX2lkCiAgICApCgogICAgIyBHdWFyZGFyIHJlbGFjacOzbgogICAgbGlua1tyZWVudmlhZG8ubWVzc2FnZV9pZF0gPSB1c2VyX2lkCgogICAgIyBSZWFjY2nDs24gdGVtcG9yYWwgYWwgbWVuc2FqZSBkZWwgdXN1YXJpbwogICAgdHJ5OgogICAgICAgICMgQWdyZWdhciByZWFjY2nDs24g8J+RjQogICAgICAgIGF3YWl0IGNvbnRleHQuYm90Ll9wb3N0KAogICAgICAgICAgICAic2V0TWVzc2FnZVJlYWN0aW9uIiwKICAgICAgICAgICAgZGF0YT17CiAgICAgICAgICAgICAgICAiY2hhdF9pZCI6IHVwZGF0ZS5lZmZlY3RpdmVfY2hhdC5pZCwKICAgICAgICAgICAgICAgICJtZXNzYWdlX2lkIjogdXBkYXRlLm1lc3NhZ2UubWVzc2FnZV9pZCwKICAgICAgICAgICAgICAgICJyZWFjdGlvbiI6IFt7InR5cGUiOiAiZW1vamkiLCAiZW1vamkiOiAi8J+RjSJ9XQogICAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgICMgRXNwZXJhcgogICAgICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoMy41KQogICAgICAgICMgUXVpdGFyIHJlYWNjacOzbgogICAgICAgIGF3YWl0IGNvbnRleHQuYm90Ll9wb3N0KAogICAgICAgICAgICAic2V0TWVzc2FnZVJlYWN0aW9uIiwKICAgICAgICAgICAgZGF0YT17CiAgICAgICAgICAgICAgICAiY2hhdF9pZCI6IHVwZGF0ZS5lZmZlY3RpdmVfY2hhdC5pZCwKICAgICAgICAgICAgICAgICJtZXNzYWdlX2lkIjogdXBkYXRlLm1lc3NhZ2UubWVzc2FnZV9pZCwKICAgICAgICAgICAgICAgICJyZWFjdGlvbiI6IFtdCiAgICAgICAgICAgIH0KICAgICAgICApCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoIkVycm9yIHJlYWNjacOzbiB0ZW1wb3JhbCB1c3VhcmlvOiIsIGUpCgojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIEFkbWluIHJlc3BvbmRlIOKGkiBlbnZpYXIgbWVuc2FqZSBhbCB1c3VhcmlvICsgcmVhY2Npw7NuIHRlbXBvcmFsCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmFzeW5jIGRlZiBhZG1pbl9yZXNwdWVzdGEodXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpOgogICAgdXNlcl9pZCA9IHVwZGF0ZS5lZmZlY3RpdmVfdXNlci5pZAoKICAgICMgU2kgTk8gZXMgZWwgYWRtaW4sIHRyYXRhciBjb21vIHVzdWFyaW8gbm9ybWFsCiAgICBpZiB1c2VyX2lkICE9IEFETUlOX0lEOgogICAgICAgIHJldHVybiBhd2FpdCByZWNpYmlyX3VzdWFyaW8odXBkYXRlLCBjb250ZXh0KQoKICAgICMgRGViZSBzZXIgcmVzcHVlc3RhIGEgdW4gbWVuc2FqZSByZWVudmlhZG8KICAgIGlmIHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RvX21lc3NhZ2UgaXMgTm9uZToKICAgICAgICByZXR1cm4KCiAgICBtc2dfaWQgPSB1cGRhdGUubWVzc2FnZS5yZXBseV90b19tZXNzYWdlLm1lc3NhZ2VfaWQKCiAgICBpZiBtc2dfaWQgbm90IGluIGxpbms6CiAgICAgICAgcmV0dXJuCgogICAgZGVzdGluYXRhcmlvID0gbGlua1ttc2dfaWRdCgogICAgIyBFbnZpYXIgcmVzcHVlc3RhIGFsIHVzdWFyaW8KICAgIGF3YWl0IGNvbnRleHQuYm90LnNlbmRfbWVzc2FnZShjaGF0X2lkPWRlc3RpbmF0YXJpbywgdGV4dD11cGRhdGUubWVzc2FnZS50ZXh0KQoKICAgICMgUmVhY2Npw7NuIHRlbXBvcmFsIGFsIG1lbnNhamUgZGVsIGFkbWluCiAgICB0cnk6CiAgICAgICAgIyBBZ3JlZ2FyIHJlYWNjacOzbiDwn5GNCiAgICAgICAgYXdhaXQgY29udGV4dC5ib3QuX3Bvc3QoCiAgICAgICAgICAgICJzZXRNZXNzYWdlUmVhY3Rpb24iLAogICAgICAgICAgICBkYXRhPXsKICAgICAgICAgICAgICAgICJjaGF0X2lkIjogdXBkYXRlLmVmZmVjdGl2ZV9jaGF0LmlkLAogICAgICAgICAgICAgICAgIm1lc3NhZ2VfaWQiOiB1cGRhdGUubWVzc2FnZS5tZXNzYWdlX2lkLAogICAgICAgICAgICAgICAgInJlYWN0aW9uIjogW3sidHlwZSI6ICJlbW9qaSIsICJlbW9qaSI6ICLwn5GNIn1dCiAgICAgICAgICAgIH0KICAgICAgICApCiAgICAgICAgIyBFc3BlcmFyCiAgICAgICAgYXdhaXQgYXN5bmNpby5zbGVlcCgzLjUpCiAgICAgICAgIyBRdWl0YXIgcmVhY2Npw7NuCiAgICAgICAgYXdhaXQgY29udGV4dC5ib3QuX3Bvc3QoCiAgICAgICAgICAgICJzZXRNZXNzYWdlUmVhY3Rpb24iLAogICAgICAgICAgICBkYXRhPXsKICAgICAgICAgICAgICAgICJjaGF0X2lkIjogdXBkYXRlLmVmZmVjdGl2ZV9jaGF0LmlkLAogICAgICAgICAgICAgICAgIm1lc3NhZ2VfaWQiOiB1cGRhdGUubWVzc2FnZS5tZXNzYWdlX2lkLAogICAgICAgICAgICAgICAgInJlYWN0aW9uIjogW10KICAgICAgICAgICAgfQogICAgICAgICkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludCgiRXJyb3IgcmVhY2Npw7NuIHRlbXBvcmFsIGFkbWluOiIsIGUpCgojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIEFkbWluIHJlYWNjaW9uYSBhIHVuIG1lbnNhamUgcmVlbnZpYWRvCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmFzeW5jIGRlZiBhZG1pbl9yZWFjY2lvbih1cGRhdGU6IFVwZGF0ZSwgY29udGV4dDogQ29udGV4dFR5cGVzLkRFRkFVTFRfVFlQRSk6CiAgICBpZiB1cGRhdGUuZWZmZWN0aXZlX3VzZXIuaWQgIT0gQURNSU5fSUQ6CiAgICAgICAgcmV0dXJuCgogICAgbXNnX2lkID0gdXBkYXRlLm1lc3NhZ2UubWVzc2FnZV9pZAogICAgaWYgbXNnX2lkIG5vdCBpbiBsaW5rOgogICAgICAgIHJldHVybgoKICAgIGRlc3RpbmF0YXJpbyA9IGxpbmtbbXNnX2lkXQogICAgcmVhY3Rpb24gPSB1cGRhdGUubWVzc2FnZS5yZWFjdGlvbnNbMF0uZW1vamkKCiAgICByZXNwdWVzdGFzID0gewogICAgICAgICLwn5GNIjogIuKcjO+4jyDCoVBlcmZlY3RvISIsCiAgICAgICAgIuKdpO+4jyI6ICLinaTvuI8gwqFHcmFjaWFzIHBvciB0dSBtZW5zYWplISIsCiAgICAgICAgIvCfmIIiOiAi8J+YgiBqYWphamEhIiwKICAgICAgICAi4p2XIjogIuKdlyBFbiB1biBtb21lbnRvIHRlIHJlc3BvbmRvLiIsCiAgICAgICAgIuKdkyI6ICLinZMgwr9Qb2Ryw61hcyBleHBsaWNhciB1biBwb2NvIG3DoXM/IgogICAgfQoKICAgIHRleHRvID0gcmVzcHVlc3Rhcy5nZXQocmVhY3Rpb24sIGYiUmVhY2Npw7NuOiB7cmVhY3Rpb259IikKICAgIGF3YWl0IGNvbnRleHQuYm90LnNlbmRfbWVzc2FnZShjaGF0X2lkPWRlc3RpbmF0YXJpbywgdGV4dD10ZXh0bykKCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgTUFJTgojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQphc3luYyBkZWYgbWFpbigpOgogICAgYXBwID0gQXBwbGljYXRpb24uYnVpbGRlcigpLnRva2VuKFRPS0VOKS5idWlsZCgpCgogICAgIyBDb21hbmRvIC9zdGFydAogICAgYXBwLmFkZF9oYW5kbGVyKENvbW1hbmRIYW5kbGVyKCJzdGFydCIsIHN0YXJ0X2NtZCkpCgogICAgIyBNZW5zYWplcyB5IHJlc3B1ZXN0YXMKICAgIGFwcC5hZGRfaGFuZGxlcihNZXNzYWdlSGFuZGxlcihmaWx0ZXJzLlRFWFQsIGFkbWluX3Jlc3B1ZXN0YSkpCgogICAgIyBSZWFjY2lvbmVzIGRlbCBhZG1pbgogICAgYXBwLmFkZF9oYW5kbGVyKE1lc3NhZ2VSZWFjdGlvbkhhbmRsZXIoYWRtaW5fcmVhY2Npb24pKQoKICAgIHByaW50KCJCT1QgSU5JQ0lBRE8sIEVTUEVSQU5ETyBNRU5TQUpFUy4uLiIpCiAgICBhd2FpdCBhcHAuaW5pdGlhbGl6ZSgpCiAgICBhd2FpdCBhcHAuc3RhcnQoKQogICAgYXdhaXQgYXBwLnVwZGF0ZXIuc3RhcnRfcG9sbGluZygpCiAgICBhd2FpdCBhc3luY2lvLkV2ZW50KCkud2FpdCgpCgphc3luY2lvLnJ1bihtYWluKCkpCg==').decode('utf-8'))
