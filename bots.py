import base64
exec(base64.b64decode('aW1wb3J0IGFzeW5jaW8KaW1wb3J0IG9zCmZyb20gdGVsZWdyYW0gaW1wb3J0IFVwZGF0ZQpmcm9tIHRlbGVncmFtLmV4dCBpbXBvcnQgKAogICAgQXBwbGljYXRpb24sCiAgICBNZXNzYWdlSGFuZGxlciwKICAgIE1lc3NhZ2VSZWFjdGlvbkhhbmRsZXIsCiAgICBDb21tYW5kSGFuZGxlciwKICAgIENvbnRleHRUeXBlcywKICAgIGZpbHRlcnMKKQoKIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBDT05GSUcKIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCiMgUGFyYSBwcnVlYmFzIGxvY2FsZXM6CiMgLSBTaSBleGlzdGUgQk9UX1RPS0VOIGVuIGVudG9ybm8gKFJhaWx3YXkpLCB1c2EgZXNlLgojIC0gU2kgbm8gZXhpc3RlLCB1c2EgZWwgcXVlIHBvbmdhcyBlbiBlbCBzdHJpbmcgKFNPTE8gcGFyYSBwcm9iYXIgZW4gUHlkcm9pZC9UZXJtdXgpLgpUT0tFTiA9IG9zLmdldGVudigiQk9UX1RPS0VOIikgb3IgInRva2VuX3BydWViYXMiCgojIElEcyBkZSBhZG1pbnMKUFJJTUFSWV9BRE1JTl9JRCA9IDU5MjU1MjkxNiAgICAgICAgICAjIHR1IGN1ZW50YSBwcmluY2lwYWwKU0VDT05EX0FETUlOX0lEID0gMTk5Nzg1Mjc3MyAgICAgICAgICAgIyA8LS0gQ0FNQklBIEVTVE8gcG9yIGVsIElEIGRlIHR1IG90cmEgY3VlbnRhCgpBRE1JTl9JRFMgPSB7UFJJTUFSWV9BRE1JTl9JRCwgU0VDT05EX0FETUlOX0lEfQoKIyBNYXBhOiAoY2hhdF9pZF9hZG1pbiwgbWVzc2FnZV9pZF9yZWVudmlhZG8pIC0+IHVzZXJfaWRfb3JpZ2luYWwKbGluayA9IHt9CgpwcmludCgiQk9UIENBUkdBTkRPLi4uIikKCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgL3N0YXJ0IC0gbWVuc2FqZSBkZSBiaWVudmVuaWRhCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmFzeW5jIGRlZiBzdGFydF9jbWQodXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpOgogICAgYXdhaXQgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdGV4dCgKICAgICAgICAi8J+RiyBIb2xhIEVzY3LDrWJlbWUgY3VhbHF1aWVyIGR1ZGEgYXF1w60gZW4gZXN0ZSBjaGF0LCBwcm9ibGVtYXMsIGV0Yy4gc29icmUgbG9zIE1PRFMuXG5cbiIKICAgICAgICAi8J+RiyBIaSBXcml0ZSBtZSBhbnkgcXVlc3Rpb25zIGhlcmUgaW4gdGhpcyBjaGF0LCBwcm9ibGVtcywgZXRjLiBhYm91dCBNT0RTLiIKICAgICkKCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgTWVuc2FqZSBkZWwgdXN1YXJpbyDihpIgcmVlbnZpYXIgYSBUT0RPUyBsb3MgYWRtaW5zICsgcmVhY2Npw7NuIHRlbXBvcmFsCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmFzeW5jIGRlZiByZWNpYmlyX3VzdWFyaW8odXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpOgogICAgdXNlciA9IHVwZGF0ZS5lZmZlY3RpdmVfdXNlcgogICAgdXNlcl9pZCA9IHVzZXIuaWQKCiAgICAjIE5vIHJlZW52aWFyIHNpIHF1aWVuIGVzY3JpYmUgZXMgdW4gYWRtaW4KICAgIGlmIHVzZXJfaWQgaW4gQURNSU5fSURTOgogICAgICAgIHJldHVybgoKICAgICMgUmVlbnZpYXIgZWwgbWVuc2FqZSBhIGNhZGEgYWRtaW4gcG9yIHNlcGFyYWRvIChhIHN1IGNoYXQgY29uIGVsIGJvdCkKICAgIGZvciBhZG1pbl9jaGF0X2lkIGluIEFETUlOX0lEUzoKICAgICAgICByZWVudmlhZG8gPSBhd2FpdCBjb250ZXh0LmJvdC5mb3J3YXJkX21lc3NhZ2UoCiAgICAgICAgICAgIGNoYXRfaWQ9YWRtaW5fY2hhdF9pZCwKICAgICAgICAgICAgZnJvbV9jaGF0X2lkPXVzZXJfaWQsCiAgICAgICAgICAgIG1lc3NhZ2VfaWQ9dXBkYXRlLm1lc3NhZ2UubWVzc2FnZV9pZAogICAgICAgICkKCiAgICAgICAgIyBHdWFyZGFyIHJlbGFjacOzbiBwYXJhIGVzZSBhZG1pbiB5IGVzZSBtZW5zYWplIHJlZW52aWFkbwogICAgICAgIGxpbmtbKGFkbWluX2NoYXRfaWQsIHJlZW52aWFkby5tZXNzYWdlX2lkKV0gPSB1c2VyX2lkCgogICAgIyBSZWFjY2nDs24gdGVtcG9yYWwgYWwgbWVuc2FqZSBkZWwgdXN1YXJpbwogICAgdHJ5OgogICAgICAgIGF3YWl0IGNvbnRleHQuYm90Ll9wb3N0KAogICAgICAgICAgICAic2V0TWVzc2FnZVJlYWN0aW9uIiwKICAgICAgICAgICAgZGF0YT17CiAgICAgICAgICAgICAgICAiY2hhdF9pZCI6IHVwZGF0ZS5lZmZlY3RpdmVfY2hhdC5pZCwKICAgICAgICAgICAgICAgICJtZXNzYWdlX2lkIjogdXBkYXRlLm1lc3NhZ2UubWVzc2FnZV9pZCwKICAgICAgICAgICAgICAgICJyZWFjdGlvbiI6IFt7InR5cGUiOiAiZW1vamkiLCAiZW1vamkiOiAi8J+RjSJ9XQogICAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoMy41KQogICAgICAgIGF3YWl0IGNvbnRleHQuYm90Ll9wb3N0KAogICAgICAgICAgICAic2V0TWVzc2FnZVJlYWN0aW9uIiwKICAgICAgICAgICAgZGF0YT17CiAgICAgICAgICAgICAgICAiY2hhdF9pZCI6IHVwZGF0ZS5lZmZlY3RpdmVfY2hhdC5pZCwKICAgICAgICAgICAgICAgICJtZXNzYWdlX2lkIjogdXBkYXRlLm1lc3NhZ2UubWVzc2FnZV9pZCwKICAgICAgICAgICAgICAgICJyZWFjdGlvbiI6IFtdCiAgICAgICAgICAgIH0KICAgICAgICApCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoIkVycm9yIHJlYWNjacOzbiB0ZW1wb3JhbCB1c3VhcmlvOiIsIGUpCgojIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQojIEFkbWluIHJlc3BvbmRlIOKGkiBlbnZpYXIgbWVuc2FqZS9tZWRpbyBhbCB1c3VhcmlvICsgcmVhY2Npw7NuIHRlbXBvcmFsCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmFzeW5jIGRlZiBhZG1pbl9yZXNwdWVzdGEodXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpOgogICAgdXNlcl9pZCA9IHVwZGF0ZS5lZmZlY3RpdmVfdXNlci5pZAoKICAgICMgU2kgTk8gZXMgYWRtaW4sIHRyYXRhciBjb21vIHVzdWFyaW8gbm9ybWFsCiAgICBpZiB1c2VyX2lkIG5vdCBpbiBBRE1JTl9JRFM6CiAgICAgICAgcmV0dXJuIGF3YWl0IHJlY2liaXJfdXN1YXJpbyh1cGRhdGUsIGNvbnRleHQpCgogICAgIyBEZWJlIHNlciByZXNwdWVzdGEgYSB1biBtZW5zYWplIHJlZW52aWFkbwogICAgaWYgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdG9fbWVzc2FnZSBpcyBOb25lOgogICAgICAgIHJldHVybgoKICAgIGFkbWluX2NoYXRfaWQgPSB1cGRhdGUuZWZmZWN0aXZlX2NoYXQuaWQKICAgIHJlcGx5X21zZ19pZCA9IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RvX21lc3NhZ2UubWVzc2FnZV9pZAoKICAgIGNsYXZlID0gKGFkbWluX2NoYXRfaWQsIHJlcGx5X21zZ19pZCkKICAgIGlmIGNsYXZlIG5vdCBpbiBsaW5rOgogICAgICAgIHJldHVybgoKICAgIGRlc3RpbmF0YXJpbyA9IGxpbmtbY2xhdmVdCgogICAgIyBDb3BpYXIgZWwgbWVuc2FqZSBjb21wbGV0byBkZWwgYWRtaW4gYWwgdXN1YXJpbyAodGV4dG8sIGZvdG8sIHZpZGVvLCBldGMuKQogICAgYXdhaXQgY29udGV4dC5ib3QuY29weV9tZXNzYWdlKAogICAgICAgIGNoYXRfaWQ9ZGVzdGluYXRhcmlvLAogICAgICAgIGZyb21fY2hhdF9pZD1hZG1pbl9jaGF0X2lkLAogICAgICAgIG1lc3NhZ2VfaWQ9dXBkYXRlLm1lc3NhZ2UubWVzc2FnZV9pZAogICAgKQoKICAgICMgUmVhY2Npw7NuIHRlbXBvcmFsIGFsIG1lbnNhamUgZGVsIGFkbWluCiAgICB0cnk6CiAgICAgICAgYXdhaXQgY29udGV4dC5ib3QuX3Bvc3QoCiAgICAgICAgICAgICJzZXRNZXNzYWdlUmVhY3Rpb24iLAogICAgICAgICAgICBkYXRhPXsKICAgICAgICAgICAgICAgICJjaGF0X2lkIjogYWRtaW5fY2hhdF9pZCwKICAgICAgICAgICAgICAgICJtZXNzYWdlX2lkIjogdXBkYXRlLm1lc3NhZ2UubWVzc2FnZV9pZCwKICAgICAgICAgICAgICAgICJyZWFjdGlvbiI6IFt7InR5cGUiOiAiZW1vamkiLCAiZW1vamkiOiAi8J+RjSJ9XQogICAgICAgICAgICB9CiAgICAgICAgKQogICAgICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoMy41KQogICAgICAgIGF3YWl0IGNvbnRleHQuYm90Ll9wb3N0KAogICAgICAgICAgICAic2V0TWVzc2FnZVJlYWN0aW9uIiwKICAgICAgICAgICAgZGF0YT17CiAgICAgICAgICAgICAgICAiY2hhdF9pZCI6IGFkbWluX2NoYXRfaWQsCiAgICAgICAgICAgICAgICAibWVzc2FnZV9pZCI6IHVwZGF0ZS5tZXNzYWdlLm1lc3NhZ2VfaWQsCiAgICAgICAgICAgICAgICAicmVhY3Rpb24iOiBbXQogICAgICAgICAgICB9CiAgICAgICAgKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KCJFcnJvciByZWFjY2nDs24gdGVtcG9yYWwgYWRtaW46IiwgZSkKCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiMgQWRtaW4gcmVhY2Npb25hIGEgdW4gbWVuc2FqZSByZWVudmlhZG8KIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KYXN5bmMgZGVmIGFkbWluX3JlYWNjaW9uKHVwZGF0ZTogVXBkYXRlLCBjb250ZXh0OiBDb250ZXh0VHlwZXMuREVGQVVMVF9UWVBFKToKICAgIHVzZXJfaWQgPSB1cGRhdGUuZWZmZWN0aXZlX3VzZXIuaWQKCiAgICAjIFNvbG8gYWRtaW5zCiAgICBpZiB1c2VyX2lkIG5vdCBpbiBBRE1JTl9JRFM6CiAgICAgICAgcmV0dXJuCgogICAgYWRtaW5fY2hhdF9pZCA9IHVwZGF0ZS5lZmZlY3RpdmVfY2hhdC5pZAogICAgbXNnX2lkID0gdXBkYXRlLm1lc3NhZ2UubWVzc2FnZV9pZAogICAgY2xhdmUgPSAoYWRtaW5fY2hhdF9pZCwgbXNnX2lkKQoKICAgIGlmIGNsYXZlIG5vdCBpbiBsaW5rOgogICAgICAgIHJldHVybgoKICAgIGRlc3RpbmF0YXJpbyA9IGxpbmtbY2xhdmVdCiAgICByZWFjdGlvbiA9IHVwZGF0ZS5tZXNzYWdlLnJlYWN0aW9uc1swXS5lbW9qaQoKICAgIHJlc3B1ZXN0YXMgPSB7CiAgICAgICAgIvCfkY0iOiAi4pyM77iPIMKhUGVyZmVjdG8hIiwKICAgICAgICAi4p2k77iPIjogIuKdpO+4jyDCoUdyYWNpYXMgcG9yIHR1IG1lbnNhamUhIiwKICAgICAgICAi8J+YgiI6ICLwn5iCIGphamFqYSEiLAogICAgICAgICLinZciOiAi4p2XIEVuIHVuIG1vbWVudG8gdGUgcmVzcG9uZG8uIiwKICAgICAgICAi4p2TIjogIuKdkyDCv1BvZHLDrWFzIGV4cGxpY2FyIHVuIHBvY28gbcOhcz8iCiAgICB9CgogICAgdGV4dG8gPSByZXNwdWVzdGFzLmdldChyZWFjdGlvbiwgZiJSZWFjY2nDs246IHtyZWFjdGlvbn0iKQogICAgYXdhaXQgY29udGV4dC5ib3Quc2VuZF9tZXNzYWdlKGNoYXRfaWQ9ZGVzdGluYXRhcmlvLCB0ZXh0PXRleHRvKQoKIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIyBNQUlOCiMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmFzeW5jIGRlZiBtYWluKCk6CiAgICBhcHAgPSBBcHBsaWNhdGlvbi5idWlsZGVyKCkudG9rZW4oVE9LRU4pLmJ1aWxkKCkKCiAgICAjIENvbWFuZG8gL3N0YXJ0CiAgICBhcHAuYWRkX2hhbmRsZXIoQ29tbWFuZEhhbmRsZXIoInN0YXJ0Iiwgc3RhcnRfY21kKSkKCiAgICAjIE1lbnNhamVzIHkgcmVzcHVlc3RhcyAoVE9ET1MgbG9zIHRpcG9zLCBleGNlcHRvIGNvbWFuZG9zKQogICAgYXBwLmFkZF9oYW5kbGVyKE1lc3NhZ2VIYW5kbGVyKGZpbHRlcnMuQUxMICYgfmZpbHRlcnMuQ09NTUFORCwgYWRtaW5fcmVzcHVlc3RhKSkKCiAgICAjIFJlYWNjaW9uZXMgZGUgbG9zIGFkbWlucwogICAgYXBwLmFkZF9oYW5kbGVyKE1lc3NhZ2VSZWFjdGlvbkhhbmRsZXIoYWRtaW5fcmVhY2Npb24pKQoKICAgIHByaW50KCJCT1QgSU5JQ0lBRE8sIEVTUEVSQU5ETyBNRU5TQUpFUy4uLiIpCiAgICBhd2FpdCBhcHAuaW5pdGlhbGl6ZSgpCiAgICBhd2FpdCBhcHAuc3RhcnQoKQogICAgYXdhaXQgYXBwLnVwZGF0ZXIuc3RhcnRfcG9sbGluZygpCiAgICBhd2FpdCBhc3luY2lvLkV2ZW50KCkud2FpdCgpCgphc3luY2lvLnJ1bihtYWluKCkp').decode('utf-8'))